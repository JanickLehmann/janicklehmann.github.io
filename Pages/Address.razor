@page "/address"
@inject IJSRuntime JSRuntime
@inject IIPService IPService

<PageTitle>Map</PageTitle>

<h1>Map</h1>

<div class="row">
    <div class="col-md-12">
        <input type="text" placeholder="Format: Address,Label" />
    </div>
</div>
<div class="row">
    <div class="col-md-12">
        <div style="width: 100%; height: 500px;">
            <LeafletMap Map="map" InitialPosition="initialPosition" InitialZoom="4.8f" />
        </div>
    </div>
</div>

@code {
    private Map map;
    private PointF initialPosition;

    protected override async Task OnInitializedAsync()
    {
        var response = await IPService.GetUserIP();
        initialPosition = new PointF(response.Latitude, response.Longitude);

        map = new Map(JSRuntime);
        map.Layers.Add(new TileLayer {
            UrlTemplate = "https://a.tile.openstreetmap.org/{z}/{x}/{y}.png",
            Attribution = "Map data &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors",
        });
    }
}